<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/favicon/32x32.png" sizes="32x32">
    <title>Hello World! Â· Kostas "xkon" Xenos</title>
    <meta name="description" content="Kostas 'xkon' Xenos' personal website.">
</head>
<body style="background: #1e1e2e; color: #cdd6f4; font-family: monospace; margin:0; padding:0;">
    <div id="terminal" style="width:100vw; height:100vh; padding:20px; box-sizing:border-box; overflow-x:hidden;"></div>
    <input id="hidden-input" style="position:absolute;opacity:0;pointer-events:none;height:0;width:0;z-index:-1;" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
    <style>
        #terminal {
            word-break: break-all;
            overflow-wrap: break-word;
        }
        .prompt-line {
            word-break: break-all;
            overflow-wrap: break-word;
        }
        body, html {
            overflow-x: hidden;
        }
        a {
            color: #fab387;
            text-decoration: underline;
        }
        a:hover {
            color: #eba0ac;
        }
    </style>
    <script>
        const terminal = document.getElementById('terminal');
        let history = [];
        let historyIndex = -1;
        let input = '';
        let inputEnabled = true;
        const prompt = 'root@xkon-dev:~# ';
        
        // Catppuccin Mocha colors
        const colors = {
            green: '#a6e3a1',
            blue: '#89b4fa',
            yellow: '#f9e2af',
            red: '#f38ba8',
            mauve: '#cba6f7',
            teal: '#94e2d5',
            text: '#cdd6f4'
        };

        function print(text = '', allowHtml = false) {
            const line = document.createElement('div');
            if (allowHtml) {
                // Allow HTML but still convert newlines to <br>
                line.innerHTML = text.replace(/\n/g, '<br>');
            } else {
                // Escape HTML and convert spaces/newlines
                line.innerHTML = text.replace(/ /g, '&nbsp;').replace(/\n/g, '<br>');
            }
            const promptLine = document.querySelector('#terminal > .prompt-line');
            if (promptLine) {
                terminal.insertBefore(line, promptLine);
            } else {
                terminal.appendChild(line);
            }
            terminal.scrollTop = terminal.scrollHeight;
        }

        function printPrompt() {
            if (!inputEnabled) return;
            const oldPrompt = document.querySelector('#terminal > .prompt-line');
            if (oldPrompt) terminal.removeChild(oldPrompt);
            const line = document.createElement('div');
            line.className = 'prompt-line';
            line.innerHTML = `<span style="color:${colors.mauve};">${prompt}</span><span id="input"></span><span class="cursor" style="color:${colors.text};">&#9608;</span>`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function updateInput() {
            const inputSpan = document.getElementById('input');
            if (inputSpan) inputSpan.textContent = input;
        }

        async function handleCommand(cmd) {
            const command = cmd.trim();
            if (command === 'help') {
                print('XKN dash, version 5.2.21(1)-release (x86_64-xkn-dev)\n'+
                    'These shell commands are defined internally.  Type `help` to see this list.\n'+
                    'A star (*) next to a name means that the command is disabled.\n'+
                    '\n'+
                    'help\n'+
                    '    Show this help message\n'+
                    'whoami\n'+
                    '    Show information about the user\n'+
                    'wp\n'+
                    '    WordPress contributions\n'+
                    'joke\n'+
                    '    Get a random programming joke\n'+
                    'reboot\n'+
                    '    Restart the terminal\n'+
                    'clear\n'+
                    '    Clear the terminal\n'+
                    'privacy\n'+
                    '    View privacy policy\n'+
                    '* sudo\n'+
                    '    Execute a command as another user\n'+
                    'exit\n'+
                    '    Exit the terminal');
            } else if (command === 'whoami') {
                print("I'm Kostas, CTO of <a href=\"https://incsub.com\" target=\"_blank\">Incsub</a>, working with the amazing people behind <a href=\"https://wpmudev.com\" target=\"_blank\">WPMU DEV</a>, <a href=\"https://campuspress.com\" target=\"_blank\">CampusPress</a> and <a href=\"https://edublogs.org\" target=\"_blank\">Edublogs</a> while snooping around WordPress as the usual <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" target=\"_blank\">Rubber Duck Debugger</a>.\n\n"+
                    'Proud member of the <a href="https://wpgreece.org/" target="_blank">WordPress Greek Community</a> as a <a href="https://wordcamp.org/" target="_blank">WordCamp & Meetup organizer</a>.\n\n'+
                    'Advocate of quality code, supporter of FOSS and part of the awesome WP Lemon team that brought to you Kirki Customizer Framework, Gridd Theme and other goodies.\n\n'+
                    'When not online or coding, I spend my time djing &amp; making beats, painting or <a href="https://xkon.dev/tattoos.html">tattooing</a>.', true);
            } else if (command === 'wp') {
                print('WordPress.org username: <a href="https://profiles.wordpress.org/xkon/" target="_blank">xkon</a>\n\n'+
                    'Organizer of:\n'+
                    '    2021 WordCamp Greece\n'+
                    '    2020 WordPress Accessibility Day\n'+
                    '    2020 WordCamp Athens\n'+
                    '    2019 WordCamp Athens\n'+
                    '    2019 WordCamp Thessaloniki\n'+
                    '    2018 WordCamp Thessaloniki\n'+
                    '    2019 WordPress Translation Day\n'+
                    '    2017 WordPress Translation Day\n'+
                    '    Athens Meetups\n\n'+
                    'Volunteer of:\n'+
                    '    2019 WordCamp Europe\n'+
                    '    2018 WordCamp Europe\n\n'+
                    'Member of the:\n'+
                    '    Core Team\n'+
                    '    Support Team\n'+
                    '    Privacy Component Maintainers\n\n'+
                    'Contributing as a:\n'+
                    '    Core Contributor\n'+
                    '    Hosting Contributor\n'+
                    '    Meta Contributor\n'+
                    '    Support Contributor\n'+
                    '    Translation Contributor\n'+
                    '    Translation Editor\n'+
                    '    Plugin Developer', true);
            } else if (command === 'whois') {
                print('You are Kostas, a developer and WordPress enthusiast.');
            } else if (command === 'privacy') {
                print('Privacy Policy:\n\n'+
                    'TL;DR: This site is hosted on Github and served via Cloudflare. It doesn\'t track you, doesn\'t use cookies, and doesn\'t collect any personal data.', true);
            } else if (command === 'sudo') {
                print("Not gonna happen buddy...");
            } else if (command === 'clear') {
                terminal.innerHTML = '';
            } else if (command === 'exit') {
                print('Goodbye!');
                inputEnabled = false;
                const oldPrompt = document.querySelector('#terminal > .prompt-line');
                if (oldPrompt) terminal.removeChild(oldPrompt);
                return;
            } else if (command === 'reboot') {
                window.location.reload();
            } else if (command === 'joke') {
                try {
                    const res = await fetch('https://v2.jokeapi.dev/joke/Programming?type=single,twopart');
                    const data = await res.json();
                    if (data.type === 'single') {
                        print(data.joke);
                    } else if (data.type === 'twopart') {
                        print(data.setup + '\n.\n..\n...\n....\n' + data.delivery);
                    } else {
                        print('No joke found.');
                    }
                } catch {
                    print('Failed to fetch a joke.');
                }
            } else if (command.startsWith('echo ')) {
                print(command.slice(5));
            } else if (command.trim() !== '') {
                print(`Command not found: ${command}`);
            }
        }

        function onKey(e) {
            if (!inputEnabled) return;
            const key = e.key;
            if (key === 'Enter') {
                print(`${prompt}${input}`);
                history.push(input);
                historyIndex = history.length;
                handleCommand(input);
                input = '';
                printPrompt();
                updateInput();
                e.preventDefault();
            } else if (key === 'Backspace') {
                input = input.slice(0, -1);
                updateInput();
                e.preventDefault();
            } else if (key === 'ArrowUp') {
                if (history.length && historyIndex > 0) {
                    historyIndex--;
                    input = history[historyIndex];
                    updateInput();
                }
                e.preventDefault();
            } else if (key === 'ArrowDown') {
                if (history.length && historyIndex < history.length - 1) {
                    historyIndex++;
                    input = history[historyIndex];
                    updateInput();
                } else if (historyIndex === history.length - 1) {
                    historyIndex++;
                    input = '';
                    updateInput();
                }
                e.preventDefault();
            } else if (key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
                input += key;
                updateInput();
                e.preventDefault();
            }
        }

        terminal.style.fontSize = '16px';
        terminal.style.lineHeight = '1.5';
        terminal.style.whiteSpace = 'pre-wrap';
        terminal.style.overflowY = 'auto';
        function showWelcome() {
            var asciiArt = `  _______
 < heya! >
  -------
    \\\\   ^__^
     \\\\  (oO)\\_______
         (__)\\       )\\/\\
           U  ||----w |
              ||     ||
`;
            print(asciiArt);
            print('Welcome to xkon.dev! <a style="color: #a6e3a1;" href="https://512kb.club" target="_blank">512KB Club - Green Team</a>', true);
            print('Type \'help\' to see available commands.');
            printPrompt();
        }
        showWelcome();
        updateInput();

        // Utility to detect mobile
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        // Only attach keydown to window if not mobile
        if (!isMobile()) {
            window.addEventListener('keydown', onKey);
        }

        // Mobile input support
        const hiddenInput = document.getElementById('hidden-input');
        function focusHiddenInput() {
            hiddenInput.focus();
        }

        document.getElementById('terminal').addEventListener('click', focusHiddenInput);
        window.addEventListener('touchstart', focusHiddenInput);

        hiddenInput.addEventListener('input', function(e) {
            input = hiddenInput.value;
            updateInput();
        });

        hiddenInput.addEventListener('keydown', function(e) {
            if (isMobile()) {
                onKey(e);
                setTimeout(() => { hiddenInput.value = input; }, 0);
            }
        });

        // Always focus hidden input on load
        focusHiddenInput();
    </script>
</body>
</html>
